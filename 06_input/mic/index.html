    <!doctype html>
    <html class="no-js" lang="en">
    <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-131686897-2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-131686897-2');
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>PHYSCI 70: Introduction to Digital Fabrication</title>
    <meta name="description" content="Index Page">
    <script src="../../js/vendor/jquery.min.js"></script>
    <script>
        $(function(){
          $("#header").load("../../header.html");
          $("#footer").load("../../footer.html");
        });
    </script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <link href="../../css/style.css" rel="stylesheet">
    <script src="../../js/vendor/modernizr.js"></script>

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    </head>
    <body>

    <div id="header"></div>

    <!-- FIRST ROW -->
    <div class="row">
        <div class="large-3  columns">
            <h3> MEMS Microphone Module  </h3>
        </div >

        <div class="small-12 medium-12 large-9  columns">

        <!--<h3> MEMS Microphone Workshop </h3>
            <p> For this workshop, please collect the following: 
                <ul> 
                    <li>Microcontroller </li>
                    <li>protoboard</li>
                    <li>LED</li>
                    <li>300-500 Ohm resistor</li>
                    <li>Adafruit MEMS Microphone Breakout SPW2430   </li>
                </ul>
            </p>-->

            <h3> Adafruit MEMS Microphone Breakout SPW2430 </h3>

    <p>The most common microphones used with microcontrollers are the MEMS and electret microphones. MEMS microphones are considered an upgrade to their electret predecessor because besides having a much smaller footprint, they also contain internal semiconductors that act as an audio preamplifier. Audio preamplifiers condition small microphone level signals (on the order of one thousandth of a volt to one tenth of a volt, 0.001V – 0.1V) to line level (up to 2 volts peak to peak).  Electret microphones need an external preamplifier circuit to boost its output signal. MEMS microphones can be analog or digital, the output of digital MEMS use either <a href='https://en.wikipedia.org/wiki/Pulse-density_modulation'>pulse density modulation (PDM)</a>, or <a href='https://en.wikipedia.org/wiki/I%C2%B2S'>I2S</a> protocols and can connect directly to a microcontroller, eliminating the need for an ADC.</p>
    
    <img src='mics.jpg' alt='MEMS wiring'>        
            
    <p>The SPW2430 board uses an analog MEMS microphone and is fairly simple to hook up. You only need to <u>connect GND to GND, Vin to 3.3-5VDC,</u> and the analog audio waveform will come out of the <u>DC pin.</u> In this case, I have the DC pin connected pin A0 on the Metro M0 Express board. The AC pin can be used for applications where AC-coupled audio is required.</p>

    <img src='mems.jpg' alt='MEMS wiring'>

    <p>If you upload the following code to your board, you can measure the amplitude or “loudness” of the audio signal generated by the SPW2430.  Audio signals are oscillating voltage signals, think of sound <i>waves</i>, so the higher the amplitude, the greater the distance between the center voltage and the high and low peaks of the audio signal. This sketch samples the microphone audio in 50 millisecond intervals, measures the highest and lowest peaks within that sample, and then prints the difference between the peaks to Serial.  In this case, it might be easier to see what’s going on by using the Serial Plotter (Tools > Serial Plotter or Ctrl+Shift+L) instead of the Serial Monitor. <br><br> </p>
         


    <pre><code class="language-arduino">
    const int sampleWindow = 50; // Sample window width in mS (50 mS = 20Hz)
    unsigned int sample;

    void setup() 
    {
       Serial.begin(9600);
    }


    void loop() 
    {
       unsigned long startMillis= millis();  // Start of sample window
       unsigned int peakToPeak = 0;   // peak-to-peak level

       unsigned int signalMax = 0;
       unsigned int signalMin = 1024;

       // collect data for 50 mS
       while (millis() - startMillis < sampleWindow)
       {
          sample = analogRead(0);   //reading DC pin from pin A0
          if (sample < 1024)  // toss out spurious readings
          {
             if (sample > signalMax)
             {
                signalMax = sample;  // save just the max levels
             }
             else if (sample < signalMin)
             {
                signalMin = sample;  // save just the min levels
             }
          }
       }
       peakToPeak = signalMax - signalMin;  // max - min = peak-peak amplitude

       Serial.println(peakToPeak);
    }
    </code></pre>
    
<h4> Serial Plotter </h4>    

   <img src='plotter.jpg' alt='MEMS wiring'>
   
<p>Note, this is not measuring the frequency of the sounds being picked up by the microphone. Analyzing frequency is a much more subtle and complex process which can be achieved by using <a href='https://www.norwegiancreations.com/2017/08/what-is-fft-and-how-can-you-implement-it-on-an-arduino/'>Fast Fourier Transform (FFT) libraries.</a></p>
   
        </div >
    </div>



    <div id="footer"></div>

    </body>
    </html>
